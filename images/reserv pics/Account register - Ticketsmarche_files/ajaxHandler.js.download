'use strict';var ajaxHandler=null;var ajaxHandlerTimer=null;var ajaxHandlerCmd=null;var ajaxIdObj=null;var ajaxDesObj=null;var ajaxResObj=null;var ajaxSelPos=0;var ajaxOldKey=null;var ajaxOldValue=null;var ajaxOtherRequestParam=null;function doAjaxOnKeyUp(id,doCmd,e){ajaxOtherRequestParam=null;return doAjaxOnKeyUp(id,doCmd,e,null)}
function doAjaxOnKeyUp(id,doCmd,e,otherRequestParam){ajaxIdObj=getById(id);ajaxDesObj=getById(id+".Des");ajaxResObj=getById(id+".Res");ajaxOtherRequestParam=otherRequestParam;if(ajaxOldKey==null){ajaxOldKey=ajaxIdObj.value;ajaxOldValue=ajaxDesObj.value}var key=e.keyCode?e.keyCode:e.charCode;if(key==38){doAjaxMoveUp();return}else if(key==40){doAjaxMoveDown();return}else if(key==27){ajaxIdObj.value=ajaxOldKey;ajaxDesObj.value=ajaxOldValue;doAjaxReset();return}else ajaxIdObj.value="";ajaxHandler=new Ajax;if(ajaxHandlerTimer!=null){clearTimeout(ajaxHandlerTimer);ajaxHandlerTimer=null}var cdKeyword=ajaxDesObj.value.trim();if(cdKeyword.length==0)ajaxResObj.innerHTML="";else ajaxHandlerTimer=setTimeout("doAjaxHandler('"+doCmd+"', '"+cdKeyword+"');",200);return true}
function doAjaxHandler(cdCmd,cdKeyword){ajaxHandlerCmd=cdCmd;var url="/ajaxHandler.json?cdCmd\x3d"+cdCmd+"\x26cdKeyword\x3d"+cdKeyword;if(ajaxOtherRequestParam!=null&&ajaxOtherRequestParam!=undefined){var key=ajaxOtherRequestParam[0];var value=ajaxOtherRequestParam[1];url+="\x26"+key+"\x3d"+value}ajaxHandler.xmlHttp.onreadystatechange=doAjaxReadyStateChange;ajaxHandler.getDataAsync(url)}
function doAjaxReadyStateChange(){if(ajaxHandler.xmlHttp.readyState==4&&ajaxHandler.xmlHttp.status==200){if(ajaxDesObj==null)return;var i;var data=ajaxHandler.xmlHttp.responseText;var resultList=eval(data);var html='\x3cdiv style\x3d"min-height: 100px;"\x3e';if(resultList.length>0){ajaxSelPos=0;html+="\x3cselect "+'id\x3d"'+ajaxIdObj.id+'.Sel" '+'multiple\x3d"multiple" '+'style\x3d"width: 100%; height: 100%;" '+'onblur\x3d"doAjaxOnBlur();" '+'onclick\x3d"doAjaxSelClick();" '+'ondblclick\x3d"doAjaxSelDblClick();" '+"\x3e";if("country"==ajaxHandlerCmd)for(i=0;i<resultList.length;i++){html+="\x3coption ";if(i==0)html+='selected\x3d"selected" ';html+='value\x3d"'+resultList[i].cdCountry+'"\x3e'+resultList[i].nmCountry+"\x3c/option\x3e"}else if("security"==ajaxHandlerCmd)for(i=0;i<resultList.length;i++){html+="\x3coption ";if(i==0)html+='selected\x3d"selected" ';html+='value\x3d"'+resultList[i].cdISIN+'"\x3e'+resultList[i].cdISIN+" - "+resultList[i].nmISIN+"\x3c/option\x3e"}else if("portfolio"==ajaxHandlerCmd)for(i=0;i<resultList.length;i++){html+="\x3coption ";if(i==0)html+='selected\x3d"selected" ';html+='value\x3d"'+resultList[i].idPortfolio+'"\x3e'+resultList[i].nmPortfolio+" - "+resultList[i].idPortfolio+"\x3c/option\x3e"}else if("account"==ajaxHandlerCmd)for(i=0;i<resultList.length;i++){html+="\x3coption ";if(i==0)html+='selected\x3d"selected" ';html+='value\x3d"'+resultList[i].idAccount+'"\x3e';if(resultList[i].isCompany)html+=resultList[i].nmCompany+", ";html+=resultList[i].nmFirstName+" "+resultList[i].nmLastName+"\x3c/option\x3e"}html+="\x3c/select\x3e"}else html+="NO RESULTS FOUND";html+="\x3c/div\x3e";ajaxResObj.innerHTML=html;ajaxResObj.style.display="block"}}function doAjaxOnBlur(){var objSel=getById(ajaxIdObj.id+".Sel");if(objSel!=null){ajaxIdObj.value=objSel.options[ajaxSelPos].value;ajaxDesObj.value=objSel.options[ajaxSelPos].text}else{ajaxIdObj.value="";ajaxDesObj.value=""}doAjaxReset()}function doAjaxRemoveBlur(){if(ajaxDesObj!=null)ajaxDesObj.onblur=null}
function doAjaxAddBlur(){if(ajaxDesObj!=null)ajaxDesObj.onblur=doAjaxOnBlur}function doAjaxReset(){if(ajaxHandlerTimer!=null){clearTimeout(ajaxHandlerTimer);ajaxHandlerTimer=null}ajaxResObj.innerHTML="";ajaxResObj.style.display="none";ajaxHandler=null;ajaxHandlerTimer=null;ajaxHandlerCmd=null;ajaxIdObj=null;ajaxDesObj=null;ajaxResObj=null;ajaxSelPos=0;ajaxOldKey=null;ajaxOldValue=null;ajaxOtherRequestParam=null}
function doAjaxMoveUp(){var objSel=getById(ajaxIdObj.id+".Sel");if(objSel==null)return;var i;for(i=0;i<objSel.length;i++)if(objSel.options[i].selected)objSel.options[i].selected=false;ajaxSelPos--;if(ajaxSelPos<0)ajaxSelPos=0;objSel.options[ajaxSelPos].selected=true;ajaxIdObj.value=objSel.options[ajaxSelPos].value;ajaxDesObj.value=objSel.options[ajaxSelPos].text}
function doAjaxMoveDown(){var objSel=getById(ajaxIdObj.id+".Sel");if(objSel==null)return;var i;for(i=0;i<objSel.length;i++)if(objSel.options[i].selected)objSel.options[i].selected=false;ajaxSelPos++;if(ajaxSelPos>=objSel.length)ajaxSelPos=objSel.length-1;objSel.options[ajaxSelPos].selected=true;ajaxIdObj.value=objSel.options[ajaxSelPos].value;ajaxDesObj.value=objSel.options[ajaxSelPos].text}
function doAjaxSelClick(){var objSel=getById(ajaxIdObj.id+".Sel");if(objSel==null)return;ajaxSelPos=objSel.selectedIndex;ajaxIdObj.value=objSel.options[ajaxSelPos].value;ajaxDesObj.value=objSel.options[ajaxSelPos].text}function doAjaxSelDblClick(){doAjaxSelClick();doAjaxReset()};