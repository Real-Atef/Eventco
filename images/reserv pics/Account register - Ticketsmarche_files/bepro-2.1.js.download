'use strict';navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")};Array.prototype.remove=function(from,to){var rest=this.slice((to||from)+1||this.length);this.length=from<0?this.length+from:from;return this.push.apply(this,rest)};function right(value,len){if(value==null)return null;else if(value.length<=len)return value;else return value.substr(value.length-len)}function removeHtml(html){var tmp=document.createElement("div");tmp.innerHTML=html;return tmp.textContent||tmp.innerText||""}var beprovalid=undefined;try{if($){var availableDates=null;var userLang=navigator.language||navigator.userLanguage;if(userLang!=undefined)userLang=userLang.toLowerCase();if(userLang=="it"||userLang=="it-it"){$.datepicker.regional["it"]={closeText:"Chiudi",prevText:"\x26#x3C;Prec",nextText:"Succ\x26#x3E;",currentText:"Oggi",monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Luned\u00ec","Marted\u00ec","Mercoled\u00ec","Gioved\u00ec","Venerd\u00ec","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayNamesMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:"",ampm:false,hourText:"Ora",minuteText:"Minuti",timeText:"Tempo"};$.datepicker.setDefaults($.datepicker.regional["it"]);$.timepicker.regional["it"]={closeText:"Chiudi",prevText:"\x26#x3C;Prec",nextText:"Succ\x26#x3E;",currentText:"Oggi",monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Luned\u00ec","Marted\u00ec","Mercoled\u00ec","Gioved\u00ec","Venerd\u00ec","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayNamesMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:"",ampm:false,hourText:"Ora",minuteText:"Minuti",timeText:"Tempo"};$.timepicker.setDefaults($.timepicker.regional["it"])}else{$.datepicker.regional["it"]={dateFormat:"dd/mm/yy"};$.datepicker.setDefaults($.datepicker.regional["it"])}$(document).ready(function(){$("div.header").click(function(){if($(this).next("div.content").css("display")=="block")$(this).next("div.content").slideUp("fast");else $(this).next("div.content").slideDown("fast")});$("div.subSection").click(function(){if($(this).next("div.content").css("display")=="block")$(this).next("div.content").slideUp("fast");else $(this).next("div.content").slideDown("fast")});$('[no-paste\x3d"no-paste"]').each(function(){this.onpaste=function(e){e.preventDefault()}});$("form").each(function(){if(this.id!=""&&$(toJQueryId(this.id)).attr("target")!="_blank"&&this.id!="accessControlForm")$(toJQueryId(this.id)).submit(function(){try{if(beprovalid!=undefined)this.beprovalid=beprovalid}catch(error){}if(this.beprovalid==undefined||this.beprovalid==null||this.beprovalid==true)if(document.getElementById("personalLoading")!=null)showBlockUI("personalLoading");else loading()})});$('form[id$\x3d"ListForm"] div[id\x3d"box980"]:first :text, form[id$\x3d"ListForm"] div[id\x3d"box980"]:first select, form[id$\x3d"List"] div[id\x3d"box980"]:first :text, form[id$\x3d"List"] div[id\x3d"box980"]:first select').each(function(){if((this.type=="text"||this.type=="select-one")&&this.value!=undefined&&this.value!=null&&this.value.trim().length>0)if(this.id!="")$(toJQueryId(this.id)).css("background-color","#eef7fb");else $("[name\x3d'"+this.name+"']").css("background-color","#eef7fb")})})}}catch(e){}
function loading(){let html='\x3cdiv class\x3d"loading" id\x3d"loading"\x3e'+'\t\x3cp class\x3d"nmMessage"\x3e'+'\t\t\x3cimg alt\x3d"Loading" title\x3d"Loading" src\x3d"/img/bko/spinner.gif" height\x3d"16" width\x3d"16"/\x3eLoading ...'+"\t\x3c/p\x3e"+"\x3c/div\x3e";let leftPP=($(window).width()-600)/2+$(window).scrollLeft()+"px";let topPP=($(window).height()-600)/2+$(window).scrollTop()+"px";$.blockUI({message:html,centerX:false,centerY:true,css:{width:"500px",position:"absolute",overflow:"auto",top:topPP,left:leftPP,border:"none",padding:"0px",backgroundColor:"#fff","-webkit-border-radius":"10px","-moz-border-radius":"10px",textAlign:"left",cursor:"null"},overlayCSS:{backgroundColor:"#14272e",opacity:.7}})}function loadScript(url){var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");script.type="text/javascript";script.src=url;head.appendChild(script)}document.onmousemove=getMouseXY;document.onmousedown=getMouseButtonDown;document.onmouseup=getMouseButtonUp;var mouseDrag=false;var mouseX=0;var mouseY=0;var mouseDragX=0;var mouseDragY=0;var mouseDragX1=null;var mouseDragY1=null;var mouseDragX2=null;var mouseDragY2=null;var mouseR=false;var mouseC=false;var mouseL=false;function getMouseButtonUp(e){if(!e)var e=window.event;if(e.which)if(e.which==1)mouseL=false;else if(e.which==2)mouseC=false;else{if(e.which==3)mouseR=false}else if(e.button)if(e.button==0)mouseL=false;else if(e.button==1)mouseC=false;else if(e.button==2)mouseR=false;mouseDrag=false}
function getMouseButtonDown(e){if(!e)var e=window.event;mouseDrag=true;mouseDragX=0;mouseDragY=0;mouseDragX1=null;mouseDragY1=null;mouseDragX2=null;mouseDragY2=null;if(e.which)if(e.which==1)mouseL=true;else if(e.which==2)mouseC=true;else{if(e.which==3)mouseR=true}else if(e.button)if(e.button==0)mouseL=true;else if(e.button==1)mouseC=true;else if(e.button==2)mouseR=true}
function getMouseXY(e){if(!e||e==null)e=window.event;var oldMouseX=mouseX;var oldMouseY=mouseY;if(document.all?true:false){mouseX=e.clientX+document.documentElement.scrollLeft;mouseY=e.clientY+document.documentElement.scrollTop}else{mouseX=e.pageX;mouseY=e.pageY}if(mouseX<0)mouseX=0;if(mouseY<0)mouseY=0;if(mouseDrag){mouseDragX=mouseX-oldMouseX;mouseDragY=mouseY-oldMouseY;if(mouseDragX1==null||mouseDragY1==null||mouseDragX2==null||mouseDragY2==null){mouseDragX1=mouseX;mouseDragY1=mouseY;mouseDragX2=mouseX;mouseDragY2=mouseY}else{mouseDragX2=mouseX;mouseDragY2=mouseY}}return true}function getById(id){var elem;if(document.getElementById)elem=document.getElementById(id);else if(document.all)elem=document.all[id];else if(document.layers)elem=document.layers[id];return elem}function applyDateTimePicker(id,dhMin,dhMax){$(toJQueryId(id)).datetimepicker();applyMinMaxDatePicker(id,dhMin,dhMax)}function applyAvailableDatePicker(id){$(toJQueryId(id)).datepicker({beforeShowDay:checkAvaiableDate})}
function checkAvaiableDate(date){dmy=date.getDate()+"-"+(date.getMonth()+1)+"-"+date.getFullYear();if($.inArray(dmy,availableDates)!=-1)return[true,"","Available"];else return[false,"","unAvailable"]}
function applyMinMaxDatePicker(id,dhMin,dhMax){let dateMin=null;if(dhMin!=null&&dhMin!=""){dateMin=parseInternalDate(dhMin).date;$(toJQueryId(id)).datepicker("option","minDate",dateMin)}if(dhMax!=null&&dhMax!=""){let dateMax=parseInternalDate(dhMax).date;if(dateMin==null)dateMin=new Date;var diffTime=dateMax.getTime()-dateMin.getTime();var diffDay=diffTime/(1E3*3600*24);console.log("diffDay: "+diffDay);$(toJQueryId(id)).datepicker("option","maxDate",dateMax)}}
function applyDatePicker(id,dhMin,dhMax){$(toJQueryId(id)).datepicker();applyMinMaxDatePicker(id,dhMin,dhMax)}function applyTimePicker(id){$(toJQueryId(id)).timepicker()}
function applyRangePicker(idFrom,idTo,idFirstDay,minDate,maxDate,qtMaxDate){$(function(){var dateFormat="dd/mm/yy",from=$(toJQueryId(idFrom)).datepicker({minDate:minDate,maxDate:maxDate,changeMonth:true,numberOfMonths:2,beforeShowDay:isIntoRange}).on("change",function(){to.datepicker("option","minDate",minDate==null?getDate(this):minDate)}),to=$(toJQueryId(idTo)).datepicker({minDate:minDate,maxDate:maxDate,changeMonth:true,numberOfMonths:2,beforeShowDay:isIntoRange}).on("change",function(){from.datepicker("option","maxDate",maxDate==null?getDate(this):maxDate)});function getDate(element){var date;try{date=$.datepicker.parseDate(dateFormat,element.value)}catch(error){date=null}return date}function isIntoRange(date){if(from.val()!=""&&to.val()!=""){var dateFrom=parseInternalDate(from.val()).date;var dateTo=parseInternalDate(to.val()).date;if(date>=dateFrom&&date<=dateTo)return[true,"ui-state-range-selected"]}return[true,""]}})}
function applyColorPicker(id,color,idFake){if(color==null||color==undefined)color="#eeeeee";$(toJQueryId(id)).spectrum({chooseText:"Done",cancelText:"Cancel",color:color,showInput:true,className:"full-spectrum",showInitial:true,showPalette:false,showSelectionPalette:true,preferredFormat:"hex",localStorageKey:"spectrum.demo",change:function(color){if(idFake!=null)$(toJQueryId(idFake)).val(color.toHexString())}})}function toJQueryId(id){return"#"+id.replace(/\./g,"\\.").replace(/\//g,"\\/")}
function getJQByID(id){return $(toJQueryId(id))}function getOpenerById(id){var elem;if(window.top.opener.document.getElementById)elem=window.top.opener.document.getElementById(id);else if(window.top.opener.document.all)elem=window.top.opener.document.all[id];else if(window.top.opener.document.layers)elem=window.top.opener.document.layers[id];return elem}
function doCommand(formName,command,value){var objDoCommand=getById("command");var objDoCommandValue=getById("commandValue");var objForm=getById(formName);objDoCommand.value=command;objDoCommandValue.value=value;objForm.submit()}function doNothing(){}function Size(width,height){this.width=width;this.height=height}
function addEvent(obj,ev,fn){if(obj.addEventListener)obj.addEventListener(ev,fn,false);else if(obj.attachEvent)obj.attachEvent("on"+ev,fn);else if(typeof obj["on"+ev]=="function"){var f=obj["on"+ev];obj["on"+ev]=function(){if(f)f();fn()}}else obj["on"+ev]=fn}var TYPE_STRING=0;var TYPE_NUMBER=1;var TYPE_SELECT=2;var TYPE_EMAIL=3;var TYPE_DATE=4;var TYPE_DATE_CHILD=5;var TYPE_DATE_SENIOR=6;var TYPE_MOBILE=7;var TYPE_DATE_YOUTH=8;var TYPE_VOID=9;var TYPE_RADIO=10;var TYPE_CHECKBOX=11;var TYPE_BUSINNESS_DATE=12;function FormItem(form,fieldName,dataType,required,groupId,armed,styleId){this.fieldName=fieldName;this.dataType=dataType;this.isEnabled=true;this.required=required;this.groupId=groupId;this.armed=armed;this.styleId=styleId;this.element=form.elements[fieldName];var obj=null;if(this.styleId!=null)obj=getById(this.styleId);else if(this.dataType!=TYPE_RADIO)obj=this.element;if(obj!=null)this.className=obj.className;else this.className=null}var formManagers=new Object;function FormManager(formName){formManagers[formName]=this;this.formName=formName;this.orderByFields=null;this.formItems=new Array(1024);for(let i=0;i<this.formItems.length;i++)this.formItems[i]=null;this.mandatoryClass=null;this.errorClass=null;try{let styleSheet=document.styleSheets[0];if(styleSheet.href==null)styleSheet=document.styleSheets[1];let rulesList=null;if(styleSheet.cssRules)rulesList=styleSheet.cssRules;else if(styleSheet.rules)rulesList=styleSheet.rules;this.fmMandatoryColor="#DDDDDD";this.fmMandatoryBorder="";for(let i=0;i<rulesList.length;i++)if(rulesList[i].selectorText==".fmMandatoryColor"){this.fmMandatoryColor=rulesList[i].style.backgroundColor;this.fmMandatoryBorder=rulesList[i].style.border;break}this.fmErrorColor="red";this.fmErrorBorder="";for(let i=0;i<rulesList.length;i++)if(rulesList[i].selectorText==".fmErrorColor"){this.fmErrorColor=rulesList[i].style.backgroundColor;this.fmErrorBorder=rulesList[i].style.border;break}}catch(e){console.log("FormManager exception: "+e)}}FormManager.prototype.refresh=function(){var thisForm=document.forms[this.formName];for(let i=0;i<this.formItems.length;i++){let formItem=this.formItems[i];if(formItem!=null){var thisElement=thisForm.elements[formItem.fieldName];if(thisElement==null||thisElement.type=="hidden")continue;try{if(formItem.dataType==TYPE_VOID||!formItem.armed||!formItem.required)this.applyNormalStyle(formItem);else this.applyMandatoryStyle(formItem)}catch(e){}}}};FormManager.prototype.applyNormalStyle=function(formItem){var obj=null;if(formItem.styleId!=null)obj=getById(formItem.styleId);else if(formItem.dataType!=TYPE_RADIO)obj=formItem.element;if(obj!=null){obj.style.border="";obj.className=formItem.className}};FormManager.prototype.applyErrorStyle=function(formItem){let obj=null;if(formItem.styleId!=null)obj=getById(formItem.styleId);else if(formItem.dataType!=TYPE_RADIO)obj=formItem.element;if(obj!=null)if(this.errorClass!=null)obj.className=(formItem.className==null?"":formItem.className+" ")+this.errorClass;else{obj.style.backgroundColor=this.fmErrorColor;obj.style.border=this.fmErrorBorder}};FormManager.prototype.applyMandatoryStyle=function(formItem){var obj=null;if(formItem.styleId!=null)obj=getById(formItem.styleId);else if(formItem.dataType!=TYPE_RADIO)obj=formItem.element;if(obj!=null)if(this.mandatoryClass!=null)obj.className=(formItem.className==null?"":formItem.className+" ")+this.mandatoryClass;else{obj.style.backgroundColor=this.fmMandatoryColor;obj.style.border=this.fmMandatoryBorder}};FormManager.prototype.add=function(fieldName,dataType,required,groupId,armed,styleId){if(required==undefined)if(dataType==TYPE_VOID)required=false;else required=true;if(groupId==undefined)groupId=null;if(armed==undefined)armed=true;if(styleId==undefined)styleId=null;this.remove(fieldName);let freeSlot=this.getFreeSlot();if(freeSlot==-1)alert("No More Slot Available for FormItem.");let thisForm=document.forms[this.formName];let formItem=new FormItem(thisForm,fieldName,dataType,required,groupId,armed,styleId);this.formItems[freeSlot]=formItem;let element=thisForm.elements[formItem.fieldName];if(element!=undefined&&(element.type=="hidden"||dataType==TYPE_VOID||!formItem.armed||formItem.armed&&!formItem.required))return;try{this.applyMandatoryStyle(formItem)}catch(e){}return formItem};FormManager.prototype.remove=function(fieldName){for(let i=0;i<this.formItems.length;i++){let formItem=this.formItems[i];if(formItem!=null&&formItem.fieldName==fieldName){this.formItems[i]=null;return}}};FormManager.prototype.setDataType=function(fieldName,dataType){for(let i=0;i<this.formItems.length;i++){let formItem=this.formItems[i];if(formItem!=null&&formItem.fieldName==fieldName){this.formItems[i].dataType=dataType;return}}};FormManager.prototype.setEnabled=function(fieldName,isEnabled){for(let i=0;i<this.formItems.length;i++){let formItem=this.formItems[i];if(formItem!=null&&formItem.fieldName==fieldName){this.formItems[i].isEnabled=isEnabled;return}}};FormManager.prototype.setArmedByGroupId=function(groupId,armed){for(let i=0;i<this.formItems.length;i++){let formItem=this.formItems[i];if(formItem!=null&&formItem.groupId==groupId)this.formItems[i].armed=armed}};FormManager.prototype.getFreeSlot=function(){for(let i=0;i<this.formItems.length;i++)if(this.formItems[i]==null)return i};FormManager.prototype.validate=function(){let formItem,thisForm,thisElement,isError=false;let value=null;try{thisForm=document.forms[this.formName];for(let i=0;i<this.formItems.length;i++){formItem=this.formItems[i];if(formItem==null||!formItem.isEnabled)continue;thisElement=thisForm.elements[formItem.fieldName];if(thisElement==null||thisElement.type=="hidden")continue;if(formItem.dataType==TYPE_VOID)continue;else if(formItem.dataType==TYPE_STRING){value=String(thisElement.value).trim();if(thisElement.getAttribute("minchar")!=null){var min=Number(thisElement.getAttribute("minchar"));if(value.length!=0&&value.length<min){this.applyErrorStyle(formItem);isError=true}}if(thisElement.getAttribute("maxchar")!=null){var max=Number(thisElement.getAttribute("maxchar"));if(value.length!=0&&value.length>max){this.applyErrorStyle(formItem);isError=true}}if(formItem.required&&formItem.armed)if(value.length==0){this.applyErrorStyle(formItem);isError=true}if(!isError)this.applyMandatoryStyle(formItem)}else if(formItem.dataType==TYPE_NUMBER){value=String(thisElement.value).replace(/,/g,"").replace(/\./g,"");if(value.length==0&&(formItem.required&&formItem.armed)){this.applyErrorStyle(formItem);isError=true}else if(value.length>0&&isNaN(value)){this.applyErrorStyle(formItem);isError=true}else if(formItem.required&&formItem.armed)this.applyMandatoryStyle(formItem);else this.applyNormalStyle(formItem)}else if(formItem.dataType==TYPE_SELECT){value=String(thisElement.options[thisElement.selectedIndex].value);if(value.length==0&&(formItem.required&&formItem.armed)){this.applyErrorStyle(formItem);isError=true}else if(formItem.required&&formItem.armed)this.applyMandatoryStyle(formItem);else this.applyNormalStyle(formItem)}else if(formItem.dataType==TYPE_EMAIL){value=String(thisElement.value);if(value.length==0&&(formItem.required&&formItem.armed)){this.applyErrorStyle(formItem);isError=true}else if(value.length>0&&!isValidEMail(value)){this.applyErrorStyle(formItem);isError=true}else if(formItem.required&&formItem.armed)this.applyMandatoryStyle(formItem);else this.applyNormalStyle(formItem)}else if(formItem.dataType==TYPE_DATE){value=String(thisElement.value);if(value.length==0&&(formItem.required&&formItem.armed)){this.applyErrorStyle(formItem);isError=true}else if(value.length>0&&!isValidDate(value)){this.applyErrorStyle(formItem);isError=true}else if(formItem.required&&formItem.armed){thisElement.value=formatDate(value);this.applyMandatoryStyle(formItem)}else this.applyNormalStyle(formItem)}else if(formItem.dataType==TYPE_RADIO){let isChecked=false;for(let nRadios=0;nRadios<thisElement.length;nRadios++)if(thisElement[nRadios].checked){isChecked=true;break}if(!isChecked){this.applyErrorStyle(formItem);isError=true}else this.applyMandatoryStyle(formItem)}else if(formItem.dataType==TYPE_CHECKBOX){let isChecked=false;for(let nCheckboxes=0;nCheckboxes<thisElement.length;nCheckboxes++)if(thisElement[nCheckboxes].checked){isChecked=true;break}if(!isChecked){this.applyErrorStyle(formItem);isError=true}else this.applyMandatoryStyle(formItem)}else if(formItem.dataType==TYPE_BUSINNESS_DATE){value=String(thisElement.value);if(value.length==0&&(formItem.required&&formItem.armed)){this.applyErrorStyle(formItem);isError=true}else if(value.length>0&&!isValidDate(value)){this.applyErrorStyle(formItem);isError=true}else if(value.length>0&&!isBusinessDate(value)){this.applyErrorStyle(formItem);isError=true}else if(formItem.required&&formItem.armed){thisElement.value=formatDate(value);this.applyMandatoryStyle(formItem)}else this.applyNormalStyle(formItem)}else{alert("Invalid formItem.dataType \x3d "+formItem.dataType);isError=true}}}catch(e){console.log("Error: "+e.name+"\r\nMessage: "+e.message+"\r\nItem: "+formItem.fieldName);console.log(e.stack);isError=true}if(isError){$.unblockUI();alert(labels.get("checkRedFields"));thisForm.beprovalid=false;return false}thisForm.beprovalid=true;return true};function isValidEMail(email){if(email==null||email=="")return false;var parts=email.split("@");if(parts.length!=2)return false;if(!isValidEmailPart(parts[0])||!isValidEmailPart(parts[1]))return false;parts=parts[1].split(".");if(parts.length<2)return false;if(parts[parts.length-1].length<2)return false;return true}
function isValidEmailPart(emailPart){if(emailPart==null||emailPart.length==0)return false;for(let i=0;i<emailPart.length;i++){let c=emailPart.charAt(i);if(c>="0"&&c<="9"||c>="a"&&c<="z"||c>="A"&&c<="Z"||c=="-"||c=="_"||c==".")continue;return false}return true}function XOption(keyParent,key,value){this.keyParent=keyParent;this.key=key;this.value=value}
function fillListBox(listbox,xoptionList,keyParent,key,emptyOption,emptyText){if(listbox.type!="select-one")return;for(let i=listbox.options.length-1;i>=0;i--)listbox.remove(i);if(emptyOption){var option=document.createElement("OPTION");option.value="";option.text=emptyText;listbox.options.add(option)}for(let i=0;i<xoptionList.length;i++)if(xoptionList[i].keyParent==keyParent){var option=document.createElement("OPTION");option.value=xoptionList[i].key;option.text=xoptionList[i].value;if(xoptionList[i].key==key)option.selected=true;listbox.options.add(option)}}var labels={labelList:{},add:function(key,value){this.labelList[key]=value},get:function(key){if(this.labelList.hasOwnProperty(key))return this.labelList[key];else return"Label "+key+" not found."}};function Ajax(){var ajaxInitialized=false;this.xmlHttp=null;if(!ajaxInitialized&&typeof XMLHttpRequest!="undefined")try{this.xmlHttp=new XMLHttpRequest;ajaxInitialized=true}catch(e){}if(!ajaxInitialized)try{this.xmlHttp=window.createRequest();ajaxInitialized=true}catch(e){}if(!ajaxInitialized)alert("Unable to initialize AJAX.")}Ajax.prototype.getStatus=function(){return this.xmlHttp.status};Ajax.prototype.getDataAsync=function(url){var url_ts=url;if(url.indexOf("?")!=-1)url_ts+="\x26ts\x3d";else url_ts+="?ts\x3d";url_ts+=new Date;try{this.xmlHttp.open("GET",url_ts,true);this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.xmlHttp.send(null)}catch(e){alert(e.description)}};Ajax.prototype.getData=function(url){var data;var url_ts=url;if(url.indexOf("?")!=-1)url_ts+="\x26ts\x3d";else url_ts+="?ts\x3d";url_ts+=new Date;try{this.xmlHttp.open("GET",url_ts,false);this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.xmlHttp.send(null);data=this.xmlHttp.responseText;if(this.xmlHttp.status==200)return data;else{alert("Unable to get data from "+url+" error "+this.xmlHttp.status);return null}}catch(e){alert(e)}};Ajax.prototype.postData=function(url,data){var data;var url_ts=url;if(url.indexOf("?")!=-1)url_ts+="\x26ts\x3d";else url_ts+="?ts\x3d";url_ts+=new Date;try{this.xmlHttp.open("POST",url_ts,false);this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.xmlHttp.send(data);data=this.xmlHttp.responseText;if(this.xmlHttp.status==200)return data;else{alert("Unable to get data from "+url+" error "+this.xmlHttp.status);return null}}catch(e){alert(e)}};class ParsedDate{constructor(date,sYMD,sHMS,year,month,day){this.date=date;this.sYMD=sYMD;this.sHMS=sHMS;this.year=year;this.month=month;this.day=day}}
function isValidDate(data){var parsedDate=parseInternalDate(data);if(parsedDate===false)return false;let date=parsedDate.date;let inDate=parsedDate.year+"-"+(parsedDate.month.length==1?"0"+parsedDate.month:parsedDate.month)+"-"+(parsedDate.day.length==1?"0"+parsedDate.day:parsedDate.day)+" "+(parsedDate.sHMS[0].length==1?"0"+parsedDate.sHMS[0]:parsedDate.sHMS[0])+":"+(parsedDate.sHMS[1].length==1?"0"+parsedDate.sHMS[1]:parsedDate.sHMS[1])+":"+(parsedDate.sHMS[2].length==1?"0"+parsedDate.sHMS[2]:parsedDate.sHMS[2]);let outDate=date.getFullYear().toString()+"-"+((date.getMonth()+1).toString().length==1?"0"+(date.getMonth()+1).toString():(date.getMonth()+1).toString())+"-"+(date.getDate().toString().length==1?"0"+date.getDate().toString():date.getDate().toString())+" "+(date.getHours().toString().length==1?"0"+date.getHours().toString():date.getHours().toString())+":"+(date.getMinutes().toString().length==1?"0"+date.getMinutes().toString():date.getMinutes().toString())+":"+(date.getSeconds().toString().length==1?"0"+date.getSeconds().toString():date.getSeconds().toString());return inDate==outDate}function isBusinessDate(data){var parsedDate=parseInternalDate(data);if(parsedDate===false)return false;let date=parsedDate.date;var dayOfWeek=date.getDay();if(dayOfWeek==0||dayOfWeek==6)return false;return true}
function parseInternalDate(data){let aData=data.split(" ");let sDate,sTime;let date,sYMD,sHMS,year,month,day;if(aData.length>1){sDate=aData[0];sTime=aData[1]}else{sDate=aData[0];sTime="00:00:00"}if(sDate.indexOf("-")!=-1){sYMD=sDate.split("-");if(sYMD.length<3)return false;year=sYMD[0];month=sYMD[1];day=sYMD[2]}else if(sDate.indexOf("/")!=-1){sYMD=sDate.split("/");if(sYMD.length<3)return false;year=sYMD[2];month=sYMD[1];day=sYMD[0]}else return false;sTime=sTime.replace(".",":");if(sTime.length<8)sTime+="00:00:00".substring(sTime.length);sHMS=sTime.split(":");if(sHMS.length<3)return false;date=new Date(Number(year),Number(month)-1,Number(day),Number(sHMS[0]),Number(sHMS[1]),Number(sHMS[2]));let parsedDate=new ParsedDate(date,sYMD,sHMS,year,month,day);return parsedDate}
function formatDate(value){var aDate=value.split("/");var token_day=new String(aDate[0]);var token_month=new String(aDate[1]);var token_year=new String(aDate[2]);if(token_day.length==1)token_day="0"+token_day;if(token_month.length==1)token_month="0"+token_month;return token_day+"/"+token_month+"/"+token_year}function isYearBetween(iStart,iEnd,value){var myDate=value.substring(0,10);var aDate=myDate.split("/");if(aDate[2]>iStart&&aDate[2]<iEnd)return true;else return false}
function format_number(p,d,ds){var r;if(p<0){p=-p;r=format_number2(p,d,ds);r="-"+r}else r=format_number2(p,d,ds);return r}
function format_number2(pnumber,decimals,decimalsSeparator){var strNumber=new String(pnumber);var arrParts=strNumber.split(".");var intWholePart=parseInt(arrParts[0],10);var strResult="";if(isNaN(intWholePart))intWholePart="0";if(arrParts.length>1&&decimals>0){var decDecimalPart=new String(arrParts[1]);var i=0;var intZeroCount=0;while(i<String(arrParts[1]).length)if(parseInt(String(arrParts[1]).charAt(i),10)==0){intZeroCount+=1;i+=1}else break;decDecimalPart=parseInt(decDecimalPart,10)/Math.pow(10,parseInt(decDecimalPart.length-decimals-1));Math.round(decDecimalPart);decDecimalPart=parseInt(decDecimalPart)/10;decDecimalPart=Math.round(decDecimalPart);if(decDecimalPart==Math.pow(10,parseInt(decimals))){intWholePart+=1;decDecimalPart="0"}var stringOfZeros=new String("");i=0;if(decDecimalPart>0)while(i<intZeroCount){stringOfZeros+="0";i+=1}decDecimalPart=String(intWholePart)+decimalsSeparator+stringOfZeros+String(decDecimalPart);var dot=decDecimalPart.indexOf(decimalsSeparator);if(dot==-1){decDecimalPart+=decimalsSeparator;dot=decDecimalPart.indexOf(decimalsSeparator)}var l=parseInt(dot)+parseInt(decimals);while(decDecimalPart.length<=l)decDecimalPart+="0";strResult=decDecimalPart}else{var dot;var decDecimalPart=new String(intWholePart);if(decimals>0){decDecimalPart+=decimalsSeparator;dot=decDecimalPart.indexOf(decimalsSeparator);var l=parseInt(dot)+parseInt(decimals);while(decDecimalPart.length<=l)decDecimalPart+="0"}strResult=decDecimalPart}return strResult}
function blankUrl(url){window.open(url)}function plusMinusLayer(imgObj,id){var divObj=document.getElementById(id);if(divObj.style.display=="block"){imgObj.src=imgObj.src.replace("Minus.gif","Plus.gif");divObj.style.display=""}else{imgObj.src=imgObj.src.replace("Plus.gif","Minus.gif");divObj.style.display="block"}}function isVisible(id){var divObj=getById(id);if(divObj!=null)return!(divObj.style.display=="none");return false}
function show(id){var divObj=getById(id);if(divObj!=null)divObj.style.display="block"}function hide(id){var divObj=getById(id);if(divObj!=null)divObj.style.display="none"}function showHide(id){var divObj=getById(id);if(divObj==null)return;if(divObj.style.display=="none")divObj.style.display="block";else divObj.style.display="none"}
function showHideAll(id){$("[id\x3d"+id+"]").each(function(){if(this.style.display=="none")if($(this).prev().prop("tagName")=="TR")this.style.display="table-row";else this.style.display="block";else this.style.display="none"})}function toggleDisabled(id){var obj=getById(id);if(obj==null)return;if(obj.disabled)obj.disabled=false;else obj.disabled=true}function fadeInFadeOut(id){if($(toJQueryId(id)).length)$(toJQueryId(id)).fadeToggle()}
function fadeIn(id){if($(toJQueryId(id)).length)$(toJQueryId(id)).fadeIn()}function fadeOut(id){if($(toJQueryId(id)).length)$(toJQueryId(id)).fadeOut()}
function selectTab(tabPrefix,position){let tabId=tabPrefix+"_tab_";let cntId=tabPrefix+"_cnt_";let countId=tabPrefix+"_count";let countObj=document.getElementById(countId);let numTabs=Number(countObj.value);for(let i=1;i<=numTabs;i++){let tabObj=document.getElementById(tabId+i);let cntObj=document.getElementById(cntId+i);$(toJQueryId(cntId+i)).removeClass("hidden");$(toJQueryId(cntId+i)).removeClass("show");if(position==i){tabObj.className="on";$(toJQueryId(cntId+i)).addClass("show")}else{tabObj.className="off";$(toJQueryId(cntId+i)).addClass("hidden")}}}function newsFormOnChange(selectObject,idNewsTypeMultimediaType){alert(selectObject.options[selectObject.selectedIndex].value)}function jumpToSite(selectObject){var url=selectObject.value;if(url!="")document.location=url}
function onLevelOver(position){countObj=document.getElementById("firstLevel_count");numTabs=Number(countObj.value);for(let i=1;i<=numTabs;i++){id1Obj=document.getElementById("firstLevel_"+i);id2Obj=document.getElementById("secondLevel_"+i);if(id1Obj!=undefined&&id2Obj!=undefined)if(position==i){id2Obj.style.display="block";x=id1Obj.offsetLeft+id1Obj.offsetWidth/2;x-=id2Obj.offsetWidth/2;if(x+id2Obj.offsetWidth>760)x=760-id2Obj.offsetWidth;else if(x<0)x=0;id2Obj.style.left=x+"px"}else id2Obj.style.display="none"}}
function moveOption(fromSelect,toSelect,all){var fromSelectObj=document.getElementById(fromSelect);var toSelectObj=document.getElementById(toSelect);var dst=toSelectObj.options.length;for(let src=fromSelectObj.options.length-1;src>=0;src--){if(fromSelectObj.options[src].getAttribute("isFiscal")=="true")continue;if(all==true||fromSelectObj.options[src].selected){var opt=new Option(fromSelectObj.options[src].text,fromSelectObj.options[src].value);toSelectObj.options[dst++]=opt;fromSelectObj.options[src]=null}}}
function selectAllOption(select){var selectObj=document.getElementById(select);for(let i=0;i<selectObj.options.length;i++)selectObj.options[i].selected=true}var type="";var days=["Mo","Tu","We","Th","Fr","Sa","Su"];var dateFieldObj;function showCalendar(dateFieldId){var container=document.getElementById("calendarcontainer");var header=document.getElementById("calendartop");header.innerHTML="Calendar";if(document.all){var entries=document.getElementsByTagName("select");for(let i=0;i<entries.length;i++)if(entries[i].className=="cal_hide")entries[i].style.display="none"}var today=new Date;document.getElementById("calendaryear").value=today.getFullYear();var monthObj=getById("calendarmonth");if(monthObj.options.length==0){monthObj.options[0]=new Option("Jan","0");monthObj.options[1]=new Option("Feb","1");monthObj.options[2]=new Option("Mar","2");monthObj.options[3]=new Option("Apr","3");monthObj.options[4]=new Option("May","4");monthObj.options[5]=new Option("Jun","5");monthObj.options[6]=new Option("Jul","6");monthObj.options[7]=new Option("Aug","7");monthObj.options[8]=new Option("Sep","8");monthObj.options[9]=new Option("Oct","9");monthObj.options[10]=new Option("Nov","10");monthObj.options[11]=new Option("Dec","11")}monthObj.selectedIndex=today.getMonth();var hourObj=getById("calendarhour");if(hourObj.options.length==0)for(let h=0;h<24;h++)hourObj.options[h]=new Option(h,h);var minuteObj=getById("calendarminutes");if(minuteObj.options.length==0)for(let m=0;m<60;m++)minuteObj.options[m]=new Option(m,m);updateMonth();dateFieldObj=document.getElementById(dateFieldId);container.style.left=mouseX+"px";container.style.top=mouseY+"px";container.style.display="block"}
function fill(day,month,hour,minutes){var date="";closeCalendar();if(day<10)date+="0";date+=String(day)+"/";month++;if(month<10)date+="0";date+=String(month)+"/";date+=document.getElementById("calendaryear").value+" ";if(document.getElementById("calendarhour").options.selectedIndex<10)date+="0";date+=document.getElementById("calendarhour").options.selectedIndex+":";if(document.getElementById("calendarminutes").options.selectedIndex<10)date+="0";date+=document.getElementById("calendarminutes").options.selectedIndex+":00";dateFieldObj.value=date}function closeCalendar(){var container=document.getElementById("calendarcontainer");if(document.all){var entries=document.getElementsByTagName("select");for(let i=0;i<entries.length;i++)if(entries[i].className=="cal_hide")entries[i].style.display="block"}container.style.display="none"}
function updateMonth(){let year=Number(document.getElementById("calendaryear").value);let month=document.getElementById("calendarmonth").options.selectedIndex;let selection=month;month+=1;var noOfDays=getNumberOfDays(month,year);var firstDay=getFirstDay(month,year);fillMonth(month,firstDay,noOfDays,selection)}function getNumberOfDays(m,y){var days=31;switch(parseInt(m)){case 4:case 6:case 9:case 11:days=30;break;case 2:if(y%4==0^y%100==0^y%400==0)days=29;else days=28;break}return days}
function prevYear(){let yearObj=document.getElementById("calendaryear");let year=Number(yearObj.value)-1;yearObj.value=String(year);updateMonth()}function nextYear(){let yearObj=document.getElementById("calendaryear");let year=Number(yearObj.value)+1;yearObj.value=String(year);updateMonth()}function getFirstDay(m,y){let d=new Date(y,m-1,1);d.setHours(12);return d.getDay()-1>=0?d.getDay()-1:d.getDay()+6}
function fillMonth(month,firstDay,noOfDays,monthIndex){var firstSet=false;var dayCounter=1;var today=new Date;var sHTML='\x3ctable cellspacing\x3d"0" border\x3d"0"\x3e\x3ctr class\x3d"head"\x3e';for(let i=0;i<days.length;i++)sHTML+="\x3ctd\x3e"+days[i]+"\x3c/td\x3e\n";sHTML+="\x3c/tr\x3e";while(dayCounter<=noOfDays){sHTML+="\x3ctr\x3e";for(let i=0;i<7;i++)if(!firstSet&&i<firstDay)sHTML+="\x3ctd\x3e\x26nbsp;\x3c/td\x3e\n";else{firstSet=true;if(dayCounter<=noOfDays)sHTML+='\x3ctd\x3e\x3ca alt\x3d"" href\x3d"javascript:fill('+dayCounter+" , "+monthIndex+');"\x3e'+dayCounter+"\x3c/a\x3e\x3c/td\x3e\n";else sHTML+="\x3ctd\x3e\x26nbsp;\x3c/td\x3e\n";dayCounter++}sHTML+="\x3c/tr\x3e"}sHTML+="\x3c/table\x3e";document.getElementById("monthtable").innerHTML=sHTML}function onlyNumbers(id){var valore=document.getElementById(id).value;valore=valore.replace(/[^\d]/g,"");document.getElementById(id).value=valore;updateMonth()}
function onChangeCdModel(objSelect){let objImg=document.getElementById("cdModelImg");objImg.src="/mm?id\x3d"+idMultimediaModel[objSelect.selectedIndex]}function onChooseMultimediaType(id){var size=mtSizes[id];let objAdvisedSize=document.getElementById("advisedSize");if(size!=null){msg="";if(size.width==-1)msg+="any x ";else msg+=size.width+" x ";if(size.height==-1)msg+="any";else msg+=size.height;objAdvisedSize.innerHTML=msg}else objAdvisedSize.innerHTML=" "}var showProductTotQty=0;var showProductMaxQty=0;function spSubQty(idObj){var obj=getById(idObj);var qty=Number(obj.value);if(isNaN(qty))qty=0;else{qty--;if(qty<0)qty=0;else showProductTotQty--;try{if(packageManager){var parts=idObj.split("_");var idProductItem=Number(parts[parts.length-1]);packageManager.subQty(idProductItem)}}catch(e){}}obj.value=qty}
function spAddQty(idObj,maxTicket){var obj=getById(idObj);var qty=Number(obj.value);if(isNaN(qty))qty=1;else{qty++;if(qty>maxTicket)qty=maxTicket;else{if(showProductMaxQty>0&&showProductTotQty>=showProductMaxQty)return;showProductTotQty++;try{if(packageManager){var parts=idObj.split("_");var idProductItem=Number(parts[parts.length-1]);packageManager.addQty(idProductItem)}}catch(e){}}}obj.value=qty}var isSubmit=false;function validatePayment(){if(isSubmit)return false;var obj;obj=getById("PaymentInfo.cdCreditCard");if(obj!=null)if(!checkCreditCard(obj))return false;obj=getById("PaymentInfo.cdCvv2");if(obj!=null)if(isNaN(obj.value)||obj.value.length!=3&&obj.value.length!=4){alert(labels.get("spInvalidCvv2"));return false}if(showPaymentFormJs.validate()){$.blockUI({message:'\x3cbr/\x3e\x3cspan style\x3d"font-size:18px"\x3e'+labels.get("paymentInProgress")+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e"});isSubmit=true;return true}return false}
function goToHttps(page){var url=new String(window.location);var urlparts=url.split("/");var newUrl="https:";for(let i=1;i<urlparts.length-1;i++)newUrl+="/"+urlparts[i];newUrl+="/"+page;document.location=newUrl}function goToHttp(page){var url=new String(window.location);var urlparts=url.split("/");var newUrl="http:";for(let i=1;i<urlparts.length-1;i++)newUrl+="/"+urlparts[i];newUrl+="/"+page;document.location=newUrl}
function activateActiveX(){if(navigator.appName=="Microsoft Internet Explorer"){var arrElements=new Array(3);arrElements[0]="object";arrElements[1]="embed";arrElements[2]="applet";for(let n=0;n<arrElements.length;n++){replaceObj=document.getElementsByTagName(arrElements[n]);for(let i=0;i<replaceObj.length;i++){parentObj=replaceObj[i].parentNode;newHTML=parentObj.innerHTML;parentObj.removeChild(replaceObj[i]);parentObj.innerHTML=newHTML}}}}var isMenuOpen=false;var slideSpeed=10;var menuObj=null;var acc=1.3;function setMenu(objectID){let fX,cX;menuObj=document.getElementById(objectID);if(isMenuOpen){fX=40-menuObj.offsetWidth;cX=0;isMenuOpen=false}else{fX=0;cX=40-menuObj.offsetWidth;isMenuOpen=true}slideMenu(cX,fX)}function slideMenu(cX,fX){if(!isMenuOpen&&cX>fX){cX-=slideSpeed;menuObj.style.left=cX+"px";setTimeout("slideMenu("+cX+","+fX+")",0)}else if(isMenuOpen&&cX<fX){cX+=slideSpeed;menuObj.style.left=cX+"px";setTimeout("slideMenu("+cX+","+fX+")",0)}else return}var lastFocusElement=null;function onloadPage(){}function addIt(cKey){if(lastFocusElement==null){alert("Click on desired field first");return}if(cKey.value=="backspace"||cKey.id=="backspace")lastFocusElement.value=lastFocusElement.value.slice(0,-1);else if(cKey.value=="space"||cKey.id=="space")lastFocusElement.value+=" ";else lastFocusElement.value+=cKey.value;lastFocusElement.focus()}
function toggle(div){var option=["part1","part2"];for(let i=0;i<option.length;i++){obj=document.getElementById(option[i]);obj.style.display=option[i]==div&&!(obj.style.display=="block")?"block":"none"}}function beproToggleAttribute(jqueryId,attributeName,attributeValue){if($(jqueryId))if($(jqueryId).attr(attributeName))$(jqueryId).removeAttr(attributeName);else $(jqueryId).attr(attributeName,attributeValue)}
function newWindow(url,myname,w,h,scroll){if(w==null)w=screen.width;if(h==null)h=screen.height;let leftPosition=screen.width?(screen.width-w)/2:0;let topPosition=screen.height?(screen.height-h)/2:0;let settings="height\x3d"+h+",width\x3d"+w+",top\x3d"+topPosition+",left\x3d"+leftPosition+",scrollbars\x3d"+scroll+",resizable";if(url.indexOf("?")!=-1)url+="\x26nohistory\x3dtrue";else url+="?nohistory\x3dtrue";var win=window.open(url,myname,settings);if(win.window.focus)win.window.focus()}
function showPriceSection(cdPriceSection){var el=document.getElementsByTagName("tr");for(let i=0;i<el.length;i++)if(el[i].id.substring(0,3)=="ps_")if(el[i].id=="ps_"+cdPriceSection)el[i].className="hl";else el[i].className=""}function selectSection(cdSection){document.showProductForm.cdSection.value=cdSection;document.showProductForm.submit()}
function syncMsCheckBox(obj){var el=document.getElementsByName("ms");for(let i=0;i<el.length;i++){el[i].checked=false;if(obj.value.length==0)continue;pos=obj.value.indexOf(el[i].value);if(pos==-1)continue;if(pos>0&&obj.value.charAt(pos-1)!=",")continue;pos+=el[i].value.length;if(pos==obj.value.length||obj.value.charAt(pos)==",")el[i].checked=true}}
function resetProductSelection(obj){var el=document.getElementsByTagName("input");for(let i=0;i<el.length;i++){if(el[i].type!="radio"||el[i].name==obj.name)continue;if(el[i].id=="idProductItemQta")el[i].checked=false}}function getDigitsOnly(s){var digitsOnly="";for(let i=0;i<s.length;i++){let c=s.charAt(i);if(c>="0"&&c<="9")digitsOnly+=c}return digitsOnly}
function getImageLink(id,name,width,maxwidth){var img="\x3cimg src\x3d'/mm?id\x3d"+id+"' alt\x3d'"+name+"'";if(width>0)if(maxwidth>0&&width>maxwidth)img+=" width\x3d'"+maxwidth+"'";else img+=" width\x3d'"+width+"'";img+="/\x3e";return img}
function wbGoTo(url,idDay,idMonth,idYear,idEvent,nmEvent,idEventType,idSpace,idVenue,idEventCategory){if(idDay==null)idDay=document.winbankForm.idDay.value;if(idMonth==null)idMonth=document.winbankForm.idMonth.value;if(idYear==null)idYear=document.winbankForm.idYear.value;if(idEvent==null)idEvent=document.winbankForm.idEvent.value;if(nmEvent==null)nmEvent=document.winbankForm.nmEvent.value;if(idEventType==null)idEventType=document.winbankForm.idEventType.value;if(idSpace==null)idSpace=document.winbankForm.idSpace.value;if(idVenue==null)idVenue=document.winbankForm.idVenue.value;if(idEventCategory==null)idEventCategory=document.winbankForm.idEventCategory.value;url=addUrlParam(url,"idDay",idDay);url=addUrlParam(url,"idMonth",idMonth);url=addUrlParam(url,"idYear",idYear);url=addUrlParam(url,"idEvent",idEvent);url=addUrlParam(url,"nmEvent",nmEvent);url=addUrlParam(url,"idEventType",idEventType);url=addUrlParam(url,"idSpace",idSpace);url=addUrlParam(url,"idVenue",idVenue);url=addUrlParam(url,"idEventCategory",idEventCategory);document.location=url}function addUrlParam(url,name,value){if(value!=null&&String(value).length>0){if(url.indexOf("?")==-1)url+="?";else url+="\x26";url+=name+"\x3d"+value}return url}function moveDiv(id,step){document.getElementById(id).scrollTop+=step}function calcMod11(value){var sum=0;var len=value.length;for(let k=1;k<=len;k++)sum+=(11-k)*(value.charCodeAt(k-1)-48);var rem=sum%11;if(rem==0)return"0";else if(rem==1)return"X";return 11-rem}
function calcMod11(value){var sum=0;var len=value.length;for(let k=1;k<=len;k++)sum+=(11-k)*(value.charCodeAt(k-1)-48);var rem=sum%11;if(rem==0)return"0";else if(rem==1)return"X";return 11-rem}function calcMod10(value){var sumOdd=0;var sumEven=0;var len=value.length;for(let i=len-1;i>=0;--i)if((i&1)==0)sumOdd+=value.charCodeAt(i)-48;else sumEven+=value.charCodeAt(i)-48;sumOdd*=3;let res=10-(sumOdd+sumEven)%10;if(res==10)res=0;return res}
function focusById(id){var obj=getById(id);if(obj!=null)obj.focus()}function chooseMultimedia(idField,dsField,prwField,cdMultimediaType){newWindow("chooseMultimedia.html"+"?nohistory\x3dtrue"+"\x26idField\x3d"+idField+"\x26dsField\x3d"+dsField+"\x26prwField\x3d"+prwField+"\x26lockMultimediaType\x3dTrue"+"\x26cdMultimediaType\x3d"+cdMultimediaType,"ChooseMultimedia","1008","600","yes")}
function removeMultimedia(idField,dsField,prwField){var obj=getById(idField);if(obj!=null)obj.value="";obj=getById(dsField);if(obj!=null)obj.value="";obj=getById(prwField);if(obj!=null)obj.innerHTML=""}function parseXML(xml){var xmlDoc;try{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(xml)}catch(e){parser=new DOMParser;xmlDoc=parser.parseFromString(xml,"text/xml")}return xmlDoc}
function showGlossaryTerm(cdApplication,cdLanguage,idGlossaryTerm){var ajax=new Ajax;var xml=ajax.getData("/glossaryTerm.xml?cdApplication\x3d"+cdApplication+"\x26cdLanguage\x3d"+cdLanguage+"\x26idGlossaryTerm\x3d"+idGlossaryTerm);var xmlDoc=parseXML(xml);var root=xmlDoc.getElementsByTagName("GlossaryTerm")[0];var title=root.getAttribute("nmGlossaryTerm");var text=root.getAttribute("dsGlossaryTerm");var container=document.getElementById("gtContainer");var gtHdr=document.getElementById("gtHdr");var gtCnt=document.getElementById("gtCnt");gtHdr.innerHTML=title;gtCnt.innerHTML=text;container.style.left=mouseX+"px";container.style.top=mouseY+12+"px";container.style.display="block"}function closeGlossaryTerm(){var container=document.getElementById("gtContainer");container.style.display="none"}
function formatNumber(val,dec){var decSep=".";var grpSep=",";var mul=Math.pow(10,dec);val=Math.round(val*mul)/mul;val=val.toString();let x=val.split(".");let x1=x[0];let x2;if(x.length>1&&dec>0)x2=decSep+x[1];else x2="";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1))x1=x1.replace(rgx,"$1"+grpSep+"$2");return x1+x2}function firstPage(formName){var objPage=getById(formName+"_page");objPage.value=1;getById(formName).submit()}
function prevPage(formName){var objPage=getById(formName+"_page");if(objPage.value>1)objPage.value=Number(objPage.value)-1;getById(formName).submit()}function nextPage(formName,pages){var objPage=getById(formName+"_page");if(objPage.value<pages)objPage.value=Number(objPage.value)+1;getById(formName).submit()}function lastPage(formName,pages){var objPage=getById(formName+"_page");objPage.value=pages;getById(formName).submit()}function recXPage(formName){getById(formName).submit()}
function goToPage(formName,page){var objPage=getById(formName+"_page");objPage.value=page;getById(formName).submit()}function getQueryParameter(parameterName){var queryString=window.top.location.search.substring(1);var parameterName=parameterName+"\x3d";if(queryString.length>0){begin=queryString.indexOf(parameterName);if(begin!=-1){begin+=parameterName.length;end=queryString.indexOf("\x26",begin);if(end==-1)end=queryString.length;return unescape(queryString.substring(begin,end))}}return null}
function setMeteoBackground(cdTempoIco,qtHour){let offY;if(cdTempoIco!=null){var cdBkg=null;if(cdTempoIco==0)cdBkg="SN";else if(cdTempoIco==1)cdBkg="TS";else if(cdTempoIco==2)cdBkg="RAL";else if(cdTempoIco==3)cdBkg="RAM";else if(cdTempoIco==4)cdBkg="RAH";else if(cdTempoIco==5)cdBkg="FG";else if(cdTempoIco==6)cdBkg="SKC";else if(cdTempoIco==7)cdBkg="FEW";else if(cdTempoIco==8)cdBkg="BKN";else if(cdTempoIco==9)cdBkg="OVC";else cdBkg="SKC";if(qtHour<6||qtHour>=21)cdBkg+="_N";if($("body").attr("class")=="hdr")offY=65;else offY=65+33;$("#cntOut").css("background","url('/img/meteo/bkg/bkg_"+cdBkg+".jpg') center "+offY+"px no-repeat")}else $("#cntOut").css("background","url('/img/meteo/bkg/bkg_SKC.jpg') center "+offY+"px no-repeat")}
function showCharLen(idText,idCounter,limLow,limUp){idText=toJQueryId(idText);idCounter=toJQueryId(idCounter);var len=$.trim($(idText).val()).length;var color="green";if(limLow!=null&&len<limLow)color="red";else if(limUp!=null&&len>limUp)color="red";$(idCounter).css("color",color);$(idCounter).text(len)}
function normalize(value){value=value.toLowerCase();value=value.replace(/["?.:,;!&\u00b0()$\u00a3%=]/g,"");value=value.replace(/[ /'\u2019]/g,"-");value=value.replace("\u00e8","e");value=value.replace("\u00e9","e");value=value.replace("\u00f2","o");value=value.replace("\u00e0","a");value=value.replace("\u00f9","u");value=value.replace("\u00ec","i");return value}
function numberKeyHandler(event){if(event.keyCode==46||event.keyCode==8||event.keyCode==9||event.keyCode==27||event.keyCode==13||event.keyCode==65&&event.ctrlKey==true||event.keyCode==88&&event.ctrlKey==true||event.keyCode==67&&event.ctrlKey==true||event.keyCode==86&&event.ctrlKey==true||event.keyCode==45||event.keyCode==16||event.keyCode>=35&&event.keyCode<=39||event.keyCode==109||event.keyCode==173||event.keyCode==189||event.keyCode==190||event.keyCode==110||event.keyCode==188||event.keyCode==116||event.keyCode==116&&event.ctrlKey==true||event.keyCode==82&&event.ctrlKey==true)return;else if(event.shiftKey||(event.keyCode<48||event.keyCode>57)&&(event.keyCode<96||event.keyCode>105))try{event.preventDefault()}catch(e){alert(e.description)}}
function alphaKeyHandler(event){var keyunicode=event.charCode||event.keyCode;if(keyunicode<=32||keyunicode==222||keyunicode>=65&&keyunicode<=122&&!(keyunicode>=97&&keyunicode<=105)||keyunicode==99||keyunicode==118)return;else try{event.preventDefault()}catch(e){alert(e.description)}}
function showHideTable(value){var field=$("#field_"+value);var table=$("#table_"+value);var arrow=$("#arrowOpen_"+value);var title=$("#titleFather_"+value);var amount=$("#amount_"+value);if(field.val()==0){table.slideUp("fast");field.val(1);arrow.removeClass("arrowOpen");arrow.addClass("arrowClose");title.removeClass("titleRowFatherOpen");title.addClass("titleRowFatherClose");amount.removeClass("amountRowFatherOpen");amount.addClass("amountRowFatherClose")}else if(field.val()==1){table.slideDown("fast");field.val(0);arrow.removeClass("arrowClose");arrow.addClass("arrowOpen");title.removeClass("titleRowFatherClose");title.addClass("titleRowFatherOpen");amount.removeClass("amountRowFatherClose");amount.addClass("amountRowFatherOpen")}}function selectDeselectAllCheckbox(checkBoxNameStartWith,checked){$('input:checkbox[name^\x3d"'+checkBoxNameStartWith+'"]:not(:disabled)').prop("checked",checked)}
FormManager.prototype.addOrderByField=function(fieldName,fieldDescription){var objOrderByList=getById(this.formName+".orderByFields");if(objOrderByList.value!=""&&this.orderByFields==null)this.orderByFields=$.parseJSON(objOrderByList.value);else if(this.orderByFields==null)this.orderByFields=new Array;var order="";var idMode=0;for(let i=0;i<this.orderByFields.length;i++)if(this.orderByFields[i].nmFieldname==fieldName){this.orderByFields[i].nmFieldDescription=fieldDescription;idMode=this.orderByFields[i].idMode;break}document.write('\x3ca class\x3d"orderByFields_'+idMode+'" href\x3d"javascript:formManagers[\''+this.formName+"'].doOrderBy('"+fieldName+'\', -1);" title\x3d"Order by"\x3e\x3cspan class\x3d"labelToOrder"\x3e'+fieldDescription+order+"\x3c/span\x3e\x3c/a\x3e")};FormManager.prototype.doOrderBy=function(fieldName,idModeToForce){var idx=-1;for(let i=0;i<this.orderByFields.length;i++)if(this.orderByFields[i].nmFieldname==fieldName){idx=i;break}if(idx==-1){this.orderByFields.push({"qtWeight":this.orderByFields.length,"nmFieldname":fieldName,"idMode":1});idx=this.orderByFields.length-1}else if(idModeToForce==-1)this.orderByFields[idx].idMode=this.orderByFields[idx].idMode%2+1;else this.orderByFields[idx].idMode=idModeToForce;if(this.orderByFields[idx].idMode==1){var max=0;for(let i=0;i<this.orderByFields.length;i++)if(this.orderByFields[i].qtWeight>max)max=this.orderByFields[i].qtWeight;this.orderByFields[idx].qtWeight=max+1}var objOrderByList=getById(this.formName+".orderByFields");objOrderByList.value=JSON.stringify(this.orderByFields);var objFormName=getById(this.formName);objFormName.submit()};FormManager.prototype.showOrderByField=function(){var orderByMsg="\x3cdiv onclick\x3d\"javascript:formManagers['"+this.formName+'\'].clearOrderedField();" class\x3d"cell clearOrder" id\x3d"clearOrder"\x3eclear order\x3c/div\x3e\x3cdiv class\x3d"cell"\x3e\x3cspan\x3eOrder by:\x3c/span\x3e\x3c/div\x3e';var labelOrder=document.getElementById("labelOrder");for(let i=0;i<this.orderByFields.length;i++)orderByMsg+='\x3cdiv class\x3d"cell clearOrder" id\x3d"clearOrder" onclick\x3d"javascript:formManagers[\''+this.formName+"'].doOrderBy('"+this.orderByFields[i].nmFieldname+"', 0);\"\x3e"+this.orderByFields[i].nmFieldDescription+"\x3c/div\x3e";if(this.orderByFields.length>0){labelOrder.className+=" orderByHeader";labelOrder.innerHTML=orderByMsg}};FormManager.prototype.clearOrderedField=function(){var objOrderByList=getById(this.formName+".orderByFields");this.orderByFields=new Array;objOrderByList.value=JSON.stringify(this.orderByFields);var objFormName=getById(this.formName);objFormName.submit()};function showMoreFunctions(){if($("#containBtnMoreFunction").hasClass("containerPadd"))$("#containBtnMoreFunction").removeClass("containerPadd");else $("#containBtnMoreFunction").addClass("containerPadd");var top=$("#containBtnMoreFunction").offset().top;var height=$("#containBtnMoreFunction").height();var menuIsVisible=$("#menuLeft").is(":visible");if(menuIsVisible==true)$("#tabMoreFunctions").css("left","320px");if(top+height>$(window).height()){var offset="-"+String($("#tabMoreFunctions").height()+15)+"px";$("#tabMoreFunctions").css("margin-top",offset);$("#containBtnMoreFunction").css("border-top","none")}else $("#containBtnMoreFunction").css("border-bottom","none");$("#tabMoreFunctions").toggle("hidden")}function checkCookieAuth(){let check=getIsCoockieAuth();if(check==true)$("#popupCookie").hide();else $("#popupCookie").show()}function getIsCoockieAuth(){return $.cookie("isCoockieAuth")=="yes"}function setIsCoockieAuth(){$.cookie("isCoockieAuth","yes",{expires:365})}
function getGoogleDistance(latA,lngA,latB,lngB){let loc1=new google.maps.LatLng(latA,lngA);let loc2=new google.maps.LatLng(latB,lngB);return google.maps.geometry.spherical.computeDistanceBetween(loc1,loc2)}
function showBlockUI(messageDivID){let id=toJQueryId(messageDivID);let buWidth=$(id).width();if(buWidth=="0")buWidth="300";let leftPP=($(window).width()-buWidth)/2+$(window).scrollLeft()+"px";let topPP=($(window).height()-$(id).height())/3+$(window).scrollTop()+"px";$.blockUI({message:$(toJQueryId(messageDivID)),centerX:false,centerY:true,css:{width:buWidth+"px",position:"absolute",overflow:"auto",top:topPP,left:leftPP,border:"none",padding:"20px",backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",textAlign:"left",cursor:"null"},overlayCSS:{backgroundColor:"#383a34",opacity:.7}});$(".blockOverlay").attr("title","Click to unblock").click(hideBlockUI);$(".closeBlock").click(function(){hideBlockUI()})}function hideBlockUI(){$.unblockUI()}
function getStringSize(value,className){let fontSize=document.getElementById("fontSize");fontSize.setAttribute("class",className);fontSize.innerText=value;let width=fontSize.clientWidth+1;let height=fontSize.clientHeight+1;return{"width":width,"height":height}}function addHtmlToField(addHtml,cdField){var addHtml2=addHtml.split(" ");for(let i=0;i<addHtml2.length;i++){var addHtml3=addHtml2[i].split("\x3d");getJQByID(cdField).attr(addHtml3[0],addHtml3[1].replace(/"/g,""))}}
function applySelectList(id){var selectObj=getJQByID(id);selectObj.combobox();if(selectObj.attr("required")!=undefined){selectObj.removeAttr("required");selectObj.next(".custom-combobox").find("input").attr("required","required")}}
function applySelectMultipleOptions(id){console.log("applySelectMultipleOptions");var checkList=document.getElementById(id);checkList.getElementsByClassName("anchor")[0].onclick=function(evt){if(checkList.classList.contains("visible"))checkList.classList.remove("visible");else checkList.classList.add("visible")};var inputs=checkList.getElementsByTagName("input");for(let i=0;i<inputs.length;i++)checkList.getElementsByTagName("input")[i].onclick=function(evt){const listChecked=[];$("#"+id+" input:checked").each(function(){listChecked.push($(this).val())});checkList.getElementsByClassName("anchor")[0].getElementsByClassName("qtAnchor")[0].innerHTML=" ("+listChecked.length+")"}}
function addDay(idDate,days){var data=$(toJQueryId(idDate)).val();var date=parseInternalDate(data).date;date=new Date(date.getTime()+days*24*60*60*1E3);var dateFormat=$.datepicker.formatDate("dd/mm/yy",date);var formatted=dateFormat+" "+(date.getHours().toString().length==1?"0"+date.getHours().toString():date.getHours().toString())+":"+(date.getMinutes().toString().length==1?"0"+date.getMinutes().toString():date.getMinutes().toString())+":"+(date.getSeconds().toString().length==1?"0"+date.getSeconds().toString():date.getSeconds().toString());$(toJQueryId(idDate)).val(formatted)}function scrollToElement(id){scrollToElement(id,2E3)}function scrollToElement(id,speed){$("html, body").animate({scrollTop:$(toJQueryId(id)).offset().top-50},speed)}function checkboxToggleClass(element,clazz){var checkbox=$(element).find("input[type\x3dcheckbox]");checkbox.prop("checked",!checkbox.prop("checked"));$(element).toggleClass(clazz)}
function runEffect(divID,effect){var selectedEffect;if(effect==null||effect==undefined)selectedEffect="bounce";else selectedEffect=effect;var options={};if(selectedEffect==="scale")options={percent:50};else if(selectedEffect==="transfer")options={to:"#button",className:"ui-effects-transfer"};else if(selectedEffect==="size")options={to:{width:200,height:60}};$(toJQueryId(divID)).effect(selectedEffect,options,500,runEffectCallback)}
function runEffectCallback(){setTimeout(function(){$("#effect").removeAttr("style").hide().fadeIn()},1E3)}
function createErrorMessage(idToDisplay,text){var form=document.getElementById(idToDisplay);var ol=document.createElement("ol");ol.setAttribute("class","errors");ol.setAttribute("id","errors");var li=document.createElement("li");li.innerHTML=text;var liClose=document.createElement("li");var btnClose=document.createElement("input");btnClose.setAttribute("type","button");btnClose.setAttribute("class","closeError");btnClose.setAttribute("id","closeError");btnClose.setAttribute("onclick","$('.errors').slideUp(500);");ol.append(li);liClose.append(btnClose);ol.append(liClose);form.append(ol);ol.style.display="block"}
function copyToClipboardMsg(idElem){var elem=document.getElementById(idElem);console.log("Start copyToClipboardMsg");var succeed=copyToClipboard(elem);var msg;if(!succeed)msg="Copy not supported or blocked.  Press Ctrl+c to copy.";else msg="Text copied to the clipboard.";$.blockUI({message:'\x3cbr/\x3e\x3cspan style\x3d"font-size:18px"\x3e'+msg+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e"});setTimeout(function(){$.unblockUI()},1E3)}
function copyToClipboard(elem){var targetId="_hiddenCopyText_";var isInput=elem.tagName==="INPUT"||elem.tagName==="TEXTAREA";var target,origSelectionStart,origSelectionEnd;if(isInput){target=elem;origSelectionStart=elem.selectionStart;origSelectionEnd=elem.selectionEnd}else{target=document.getElementById(targetId);if(!target){var target=document.createElement("textarea");target.style.position="absolute";target.style.left="-9999px";target.style.top="0";target.id=targetId;document.body.appendChild(target)}target.textContent=elem.textContent}var currentFocus=document.activeElement;target.focus();target.setSelectionRange(0,target.value.length);var succeed;try{succeed=document.execCommand("copy")}catch(e){succeed=false}if(currentFocus&&typeof currentFocus.focus==="function")currentFocus.focus();if(isInput)elem.setSelectionRange(origSelectionStart,origSelectionEnd);else target.textContent="";console.log("succeed? "+succeed);return succeed}
function checkDhBirth(idDhBirth){let dhBirthDate=getById(idDhBirth);try{if(dhBirthDate==undefined||dhBirthDate.value==""||dhBirthDate.value==null)return false;let dayAfterBirth=0;let today=new Date;let one_day=1E3*60*60*24;let str=dhBirthDate.value;let n=str.split("/");let dd=n[0];let mm=n[1];let yyyy=n[2];if(n.length!=3||dd==""||dd>31||mm>12||mm=="")throw labels.get("dateFormatField");if(mm=="01"){mm="12";yyyy=yyyy-1}else mm=mm-1;var birth=new Date(yyyy,mm,dd);var difference=today-birth;dayAfterBirth=Math.round(difference/one_day);if(dayAfterBirth<=6574){alert(labels.get("dateNotAdult"));dhBirthDate.value="";return false}}catch(err){alert(err);dhBirthDate.value="";return false}return true}function numberWithCommas(number){var userLang=navigator.language||navigator.userLanguage;if(userLang!=undefined)userLang=userLang.toLowerCase();if(userLang=="it"||userLang=="it-it")return number.toString().replace(".",",");else return number}
function checkInputNumber(element,qtMin,qtMax){console.log("checkInputNumber.");let val=$(element).val();if(qtMin!=null&&val<qtMin)$(element).val("");else if(qtMax!=null&&val>qtMax)$(element).val("")}
function checkInputNumberMultiple(element,idElementToCheck){console.log("checkInputNumberMultiple:");let multiple=Number($(element).val());let inputToCheck=Number(getJQByID(idElementToCheck).val());let mod=inputToCheck%multiple;if(inputToCheck<multiple){getJQByID(idElementToCheck).val(multiple);idElementToCheck=multiple}else if(mod>0)getJQByID(idElementToCheck).val(inputToCheck-mod)}
function checkInputDateMinMax(elementFrom,elementTo){console.log("checkInputDate");var dataFrom=$(toJQueryId(elementFrom)).val();var dateFrom=parseInternalDate(dataFrom).date;var dataTo=$(toJQueryId(elementTo)).val();var dateTo=parseInternalDate(dataTo).date;console.log(dataFrom+" - "+dataTo);console.log(dateFrom>dateTo);if(elementFrom!=null&&elementTo!=null&&dateFrom>dateTo){console.log("no good!");getJQByID(elementTo).val(getJQByID(elementFrom).val())}}
function onRecaptchaClick(cdCaptchaPublicKey,idForm,cdAction){grecaptcha.ready(function(){try{grecaptcha.execute(cdCaptchaPublicKey,{action:"submit"}).then(function(token){$("\x3cinput\x3e").attr({type:"hidden",id:"g-recaptcha-response",name:"g-recaptcha-response",value:token}).appendTo($("#"+idForm));$("\x3cinput\x3e").attr({type:"hidden",id:cdAction,name:cdAction,value:cdAction}).appendTo($("#"+idForm));if(getById(idForm).reportValidity()&&getById(idForm).checkValidity())$("#"+idForm).submit();else alert(labels.get("checkRedFields"))})}catch(e){console.error(e);if($("#g-recaptcha-response"))$("#g-recaptcha-response").remove();if($("#"+cdAction))$("#"+cdAction).remove()}})}function removeToAllFieldsRequiredAttribute(){$("input").each(function(){if($(this).attr("required"))$(this).removeAttr("required")});$("select").each(function(){if($(this).attr("required"))$(this).removeAttr("required")})}
function initTinyMCE(mode,elements){tinyMCE.init({mode:mode,elements:elements,valid_elements:"*[*]",cleanup_on_startup:false,remove_script_host:false,convert_fonts_to_spans:true,button_tile_map:true,entities:"",extended_valid_elements:"param[name|value],embed[src|type|wmode|width|height],object[classid|codebase|width|height]",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor colorpicker textpattern"],toolbar1:"bullist numlist outdent indent | link image | forecolor backcolor",width:"98%",media_strict:false,convert_urls:false,relative_urls:true,templates:[{title:"Template 1",description:"Description 1",url:"http://localhost.bemils.com/js-common/TestTemplate.html"},{title:"Template 2",description:"Description 2",url:"http://www.bemils.com/homePage.html"}]})};